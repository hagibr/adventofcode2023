puzzle_input = '''#.###.##..#....
.#.###.....####
...##...###.##.
...######..#..#
##.#..#.##..##.
.#.##..#....##.
##..##.#...####
.####..##.#####
#.####.#....##.
..#.###.#..#..#
##...####...##.
##...####...##.
..#.###.#..#..#
#.###..#....##.
.####..##.#####

##..#.#......#..#
.....#..#.#######
...########...##.
..#.#.#.###...##.
..#.#..#.#.#.#..#
..##...#.##.#.##.
###.####..##.#...
....#..#.#..#.##.
....#.###..##....
..##.#..##.######
...##..#.#.##....
...#.#..#........
###....##..######
..#...##..##.#..#
..#.......#...##.

#####.###
.#.###..#
##...##.#
....###.#
....###.#
##...##.#
.#.###..#
#####.###
..##.#.##
###...##.
.##.#.###
.##.#.#.#
###...##.

..###...#####
#######..#..#
########.#..#
..###...#####
##.###..#####
#.....###.##.
#..###..##..#
.#.#.##...##.
.#.##########
..###.###.##.
####..#.#....
##.##.....##.
###...##.....
...#.#.##....
.##..#.#.#..#

#......#...
.#.#.##....
##..####.##
...##....##
..#...##...
#..#.......
##..#.#..##
###..#.####
###..#.#.##

..#......#...
###.####.####
.#..#..#.##..
.#..#..#..#..
##..####..###
##..####..###
.....##......
.###.##.###..
##..####..###
#.########.##
.##......##..
.#..#..#..#..
#...####...##

#....##.#..#.##
.#..#.##.####.#
.#..#.##.####.#
#....##.#..####
#.##.#..#.####.
......#..#....#
.#..#...#..##.#
.#..#.###.##.##
..##...##...#.#
......#.####.#.
#.##.#..#......
..##...###.#.#.
......#..##.#.#

..##.######
##.....#..#
..#.###.##.
#.###..####
.##.#..#..#
.##....#..#
#.###..####

...#.####.#
##.#..##..#
##.........
..##..##..#
##..#....#.
##....##...
..#........
##..#.##.#.
...#......#
...#.###..#
...########
####..##..#
..#.##..##.
###..####..
..#.######.

##.....###...
##.....###...
##.##.####.##
###..###.##..
........#..#.
#.#..#.#..##.
##.##.###..#.

...##.####.#.#.
..####.#...#...
.....##.#.#..##
##.....###.#.#.
######.###.#...
##.##....#.####
...#.####..####
..###....##.##.
..###..#...#..#
..###..##..#..#
..###....##.##.
...#.####..####
##.##....#.####
######.###.#...
##.....###.#.#.

##.#####.####..
..#.##..#.##.#.
..#.########...
###.###.###....
...#####.##.#..
##.#..#..#...#.
...##....#..#..
##..##...##.##.
##..##..####.#.
##....#.#.##..#
###...#.#.##..#
##..##..####.#.
##..##...##.##.

...#.##.##.##.#..
#....#..##..#....
.#..#.##..##.#..#
.#..#.##..##.#..#
#....#..##..#....
...#.##.##.##.#..
####.##....##.###
.#.##........##.#
######.#..#.#####
#.##...#..#...#..
.#.#....##....#.#
....#.#.##.#.#...
##..###.##.###..#
#.#.#.#....#.#.#.
.######....######

..#..###.
..#.#.###
..#...###
.##....##
....#.#.#
####.##..
####.##..
....#.#.#
.##....##
..#...###
..#.#.###

....##.##
#.##.....
###....#.
###....#.
#.##.....
....##.##
#.#..####
#.#.....#
.##.#.#.#
##...#.#.
##...#.#.
.#..#.#.#
#.#.....#
#.#..####
....##.##
#.##.....
###....#.

###.#........
#.#.#.#.##.#.
##.##.#.##.#.
..##.#.#..#.#
.##...#....#.
.#...##.##.##
.#...##.##.##
.##...#....#.
..##.#.#..#.#
##.##.#.##.#.
#.#...#.##.#.
###.#........
#.....#.##.#.

#.##..###..####
.##...#..###..#
.##...#..#.#..#
.#.######..##.#
#....##.###.###
.###..#.##.##..
...#.#.##..#...
#.........###.#
###.#.....##..#
###.#.....##..#
#.........###.#
...#.#.##..#...
.###..#.##.##..
#....##.###.###
.#.######..##.#
.##...#..#.#..#
.##...#..###..#

.....######....
..#.#..##..#.#.
##.#........#.#
###....##....##
##.....##.....#
..############.
..#...#..#.....

##...##
#..###.
#...#.#
#...#.#
#..###.
##...##
###.##.
#.#..##
..##..#
.#..#..
#.##..#
#....#.
#....#.
#.#...#
.#..#..

#..##.###..
.##....#.#.
......##.#.
#..#.###.##
######.....
######.....
#..#.######

...##..##.#..###.
..#.#..#.#....##.
####.##.####....#
.##.#..#.##..#..#
.#.#....#.#...###
##..####..###..#.
##..####..###..#.
.#.#....#.#...###
.##.#..#.##..#..#
####.##.####....#
..#.#..#.#....##.

####.#...
...#.####
##...##..
###.#....
..#.#.#..
###....##
####.####
..##.#..#
##.###..#
.#.#..#.#
###.###..
###.#.###
######.#.
..#.#.###
####....#
####....#
..#.#.###

#..##..##..##..##
##.#....####....#
##.######..######
...######..######
#..#.##.#..#.##.#
#####.########.##
###..##..##..##..

###....####
####...##.#
##.##.##..#
####..##..#
##.##.#.##.
##.###.####
####.######
####.#..##.
.....#.#..#

..##.#...
..##.##..
..#..##.#
##.######
..#.#..#.
##.#.#.##
...##..#.

....###..###...
.....##..##....
..##..#..#..##.
...###....###..
##.##########.#
##.........#..#
####.#....#.###
..#.###..###.#.
##....#..#....#

.....#.#.####.#
#....##.#..#..#
##..##.#.....#.
#....####......
..##..##..#....
.####.#####.##.
##..##.##.##.##
##..##.#.....#.
######.##.###.#
..##..#.##..#.#
..##..#.##..#.#
######.##.###.#
##..##.#.....#.

.#####...#.
.#..####..#
#####.##.##
#.#.##.###.
.###..####.
#.##.......
..##.##....
..##.##....
#.##.......
.###..####.
#.#.##.###.
.####.##.##
.#..####..#
.#####...#.
##.....####
.#.#..###..
.#.#..###..

#.#.##.....
#..#####..#
..#..#.....
..#..#.....
#..#####..#
#.#.##.....
#......####
##.#.#..##.
.#.####...#
..###.#....
..#...#####
....####..#
#.#.####..#
#..####....
#.#.#.#####
#..#.#.....
...#.######

##..##........#
..##..#..#.#.#.
..##..#..#.#.#.
##..##........#
.####.#.#.#....
..##.....##..##
#....######.#..
.####....##.#..
.####.#.#...#.#
######.###.#..#
.........##....
.####.#..###..#
########..#....
.####......#..#
........#####.#
#...###.....#.#
......#.....##.

#..##...##.
###..####.#
####...####
.##.#..#..#
....##....#
####..#...#
####..#...#
....##....#
.##.#..#..#

.######.#..
#..##..#.##
##.##.##...
.######....
..#..#.....
#########..
.##..##....
##.....#.##
..####.....
#########..
#.####.#.##
.######....
.##..##.###
#......#...
##....##.##
#......#.##
...##...#..

#....###.#.#..#
#....###.###..#
..#..####..####
.###..##.##.##.
...###.##.#....
....###....####
..#..#.#...#..#
.#.####..#..##.
#..#.###..#####
###.#.###..####
..######..##..#

###.##.####
##.####.###
####..#####
##......##.
.#.####.#..
..#.##.#...
..#.##.#..#
...####....
##.#..#.###

.##########
....#...#.#
....#...###
.##########
......###.#
#..#.###.#.
#..#.###.#.

#######..##
##..##.####
##..###.###
.#..#.###..
..##.......
....#.##.##
..##...##..
.#..#.#.#..
..##..##.##
.####.###..
#....######
......#.#..
######.#...

..#..#.##..##
###.#...#..#.
..####.######
...#...#.##.#
#..#.#.......
#.#..##..##..
#.###........
#.#.#........
#.#..##..##..

...####..#..#.#
###....#..#..##
.#....#.#.#.###
.#.....#.......
#.##...##.#..##
####..#......##
#...#.#.#.#.#..
#.##.#####..#..
.....####.#####
.....####.#####
#.##.#####..#..

........##...
########...#.
##########...
#########.#..
#########.#..
#..##..#.#.##
.##..##..####
########..#.#
##.##.##.#.#.

..#...###.####.#.
..#...###.####.#.
#.#......#..#...#
#..#...#######...
##.##...#####.#.#
######...###..##.
#######..###..##.

##..#...###
..###.#.##.
##.#.#.#.#.
..#.##.#...
####.####..
####.#.#...
...#..##.##
...#..#.#..
..####..###
...#.####.#
...######.#

.##..##....##..
.##..##....##.#
##########...#.
#.#..#.##..#.#.
##....##.####.#
#.####.#..#....
#.#..#.#.#..#..

####.....#.##.#
..##...#....###
..##...#....###
####.....#.##.#
#...#..##.#..##
#..##.....#...#
#.##....##.##.#
#.##.##..##..#.
.#....##.#.#.##
##.#.#####...#.
##.#.#####..##.

....#..##
.##...###
....#....
.##.##.#.
.##...#.#
.##...#.#
.##.##.#.
....#....
.##...###
....#..##
.###...#.
#..#.....
.....#..#
#..#.####
........#
######...
####.....

.#....#.#.#..
#.####.###.##
.#####..#..##
########.##..
##.##.##.....
#..##..#...##
#########.#..
##.##.###..##
.#.##.#......

#..###..###
......##...
.....#..#..
##..#....#.
....##..##.
##.#.#..#.#
..####..###
##.##.##.##
..##.####.#
..##.####.#
....#.##.#.
....#....#.
..#........
###........
##.#.####.#

#....#...#...#.##
.#..#...##..#....
.####.##..#..##..
..###.....##..#..
.####..#..##.####
..##..###.#.#.###
##..##.#.###.####
######...#.##....
#######.....##.##
#....##..#.#.....
.#..#.#...#...#..

#.####...##
##..##..#.#
.####......
..##..#....
.#..#..#.##
.####.#....
#....###.#.
##..###.#..
#.##.##.###
.#..#.##..#
.......#...
.####.#..#.
##..###....
##..###....
.####.#..#.

.##...#..##
..##.#.##..
#.#..#..###
.#####.#.##
..#..###...
###..#...##
####.##....
..#..###...
...#.##....
....#....##
.....#..#..
####..#.#..
###.#.#.#..
#..##......
#..#.#..#..
.#.#..#..##
.#.#.##..##

####..#...#..#.
####.....##..##
#..#.....##..##
#..#.##.#..##..
#####..###.##.#
...#...........
.##..#...######
#..#.#.#...##..
#..##.....#..#.
.....#...##..##
#..####...#..#.
.##...#.##....#
.##.####..#..#.
.....####......
.....##...#..#.
####.....##..##
####..#.##....#

...#...##...#
##.##.####.##
##.##..##..##
#######..####
#######..####
##.##..##..##
##.##.####.##
...#...##...#
#......##....
.##.#......#.
#..##.#..#.##
.#.#.######.#
##.#...##.#.#

.#.###.#.
.######.#
##.#...##
#.##....#
####.####
#.##....#
#.##....#
#.##.####
#.##....#
##.#...##
.######.#
.#.###.#.
.#..#...#
.###.#.#.
.###.#.#.

.....##
......#
#.#...#
.#.##.#
.#.##.#
#.#...#
......#
.....##
.####..

.#####.......#..#
#.#.#.#....#....#
...#...#.##....##
######...##.#.#..
#.#..####...##.##
####....##....##.
####....##...###.
#.#..####...##.##
######...##.#.#..
...#...#.##....##
#.#.#.#....#....#
.#####.......#..#
.#.##...#.###...#
..####.###..####.
..#.#..#.##.#....
..#.#..#.##.#....
..####.###..####.

.#..#.#.#.#.#
.#..#.#.#....
..##..#..#.##
##..####...##
##..####...##
..##..#.##.##
.#..#.#.#....
.#..#.#.#.#.#
#.##.##...#.#
..##...##...#
......##.#.#.
######.......
##..#######..
#.##.###.....
######....##.

.###..####.##..#.
..#....##..##.#.#
..#.#.....##.#.#.
..###.##..#..####
.#.#.#.#.#..###.#
......#########.#
.....##########.#
###..##..######..
##.###.......###.
##.###.......###.
###..##..######..
.....##########.#
......#########.#

#.##...
##.####
..##...
...#...
##.##..
.#...##
##...##
.##.#..
..###..
.#.####
#..#...
#####..
.##....
.##....
###.#..

#....##..##..##
#.##.#..####..#
##..###.#..#.##
.........##....
.#..#.##.##.##.
#.##.####..####
..##....#.##...
.#..#..##..##..
#.##.##.#..#.##

###.##....##.
##...........
##.##......##
...##.#..#.##
..####....###
..####....###
...##.#..#.##
##.##......##
##...........
###.##....##.
.####.#..#.##
##.#.#.##.#.#
..##.#....#.#
#...#..##..#.
..#.#..##..#.
##.....##....
.###.######..

#....#.######.#..
##..##.###.##.##.
.#..#.#.####.#.#.
######.#....#.###
######.#....#.###
######.#....#.###
.####.#......#.##

.#.#.##....##.#
...#..##..##..#
..###........##
.#...#.####.#..
..##.##.##.##.#
###...##..##...
..###.##..##.#.
##..##..##..##.
###...#.##.#...
.#..##..##..##.
...###......###
##.###.#..#.###
.####........##
.####........##
##.###.#..#.###

#.##.####.##.
....##..##...
..#.#....#.#.
.###......###
.###......###
..#.#....#.#.
....##..##...
#.##.####.##.
.#.#..#...#.#
...###..###..
....######...

#........##.#
####.#.#.##..
####.#.#..#..
#........##.#
.#.##.#..#.#.
.#.##.#..#.#.
#........##.#
####.#.#..#..
####.#.#.##..
#........##.#
.....##..###.
##...##.###..
..#....##.#.#
....##.#..###
.##....#.#.#.
.########.#.#
#.#####..####

....#.#..#.
....#.#..#.
.#.###..#..
..###......
##...##...#
####.#.###.
..##.......
..##.......
####.#.###.
##...##...#
..###......
.#.###..#.#
....#.#..#.

...##.###.##.
#....#..##.##
.#.#..#..##..
.##....#..##.
###....#..##.
##..#.#.##.##
.#..#..#..#..
.#..#..#..#..
##..#.#.##.##
###....#..##.
.##....#..##.

#.#...#..#...#.
#.#...#..#...#.
...#....#..#..#
###..#.#.####.#
..#.#.##.###...
....###.##.####
#.####...#.##.#
.##.#...##..#.#
.##.##......#.#
.###.#.#....###
..#......###.##
.#.##...#....##
.#..#..#.#.##.#
.#..##.#.#.##.#
.#.##...#....##
..#......###.##
.###.#.#....###

#.####.##..
#..##..####
#......####
#.####.##.#
#.####.#.#.
#.####.###.
..#..#..###
#.#..#.##.#
.#....#.###
.##..##.##.
..#..#....#
.#..#.#.#.#
###..###...
###..#####.
###..#####.

#.##.#.#...
.####..##..
.#..#..####
##..###.###
#....###...
#.##.#...##
.#..#......
.####...###
########.##
#....#..###
.#..#...#..
##..#.#####
##..###.###

............###
#.########.##..
#.#..##..#.#.##
...######...#..
.##########.#..
#.#..##....#...
.##......##....
..#.####.#.....
#..#.##.#..#.##
#..##..##..#.##
.#.######.#.#..

#..##..#.####
#########.##.
#..####.#####
#..##...#####
#######......
.##.##....##.
#..#..##.....
.##......#...
#..#..#...##.
#########.##.
#..####..####
########..##.
.##...##.####

...##..####
...##..###.
##.#.#####.
...#.#..###
##...##....
..#.....##.
..#.##.#.##

.##..#.
####...
...##.#
.##.#..
####..#
.##.#..
....###
....###
.##.#..

#.#.....##..##.
.###.##..#..#.#
##.#...#..#.###
.....#........#
##..#.##...#.##
....#..#####..#
##..#.#..#.###.
##..#.#..#.###.
#...#..#####..#
##..#.##...#.##
.....#........#
##.#...#..#.###
.###.##..#..#.#
#.#.....##..##.
#.#.....##..##.

####...###...#..#
.##.##.#....##..#
.##....##.#.#..##
....##.......##.#
.##.##...#.#.##..
####..###.#.#.#..
#..###.##........
.##..##.#..###...
#..##.#.#..##....
.#...#.#.#.#.####
....#....#.#...##
#..####..###..#.#
#..##...###.##...
.##....#.#.#..###
####.###.#...#...
####.###.#...#...
.##....#.#.#..###

.#...####.#######
.#.#.#..#........
..#.#...#..##..##
..###.#.#.###..##
###......##.####.
#.####..#...####.
...#####...#...##
#...#..#.#.##..##
##.....#.#..####.
##.....#.#..####.
#...#..#.#.##..##

..#....#.
..#.###..
##...####
.....#...
..#...###
..#.##.#.
..#.##.#.
..#...###
.....#...
##...##.#
..#.###..
..#....#.
##.....##
..#...##.
####.....
..#.##.##
...#...#.

#....#...####
#.##.#.#.####
######...##..
##..####..#..
##..###..##..
.#..#..#.#...
......###..#.
.#..#.#######
#######.##.##
######..##.##
##..###.###..
.####.##..#..
.......##..##

.#....##....#
.#....##....#
#...#.##.#...
#....####..#.
..#.######.#.
#..#.#..#.#..
###.#.##.#.##

#....##
.####.#
.####..
#....##
#.##.#.
#....##
#.##.##

..#####.#.###..##
##.#.#..##...#.#.
#..#..#########.#
#..#..#########.#
##.#.#..##...#.#.
..#####.#.###..##
..#.#.###.#.#...#
..#.#...#.#......
.#####......#.##.
.#..#.###.##..###
.####..##...#..#.
.####..##...#..#.
.#..#.#.#.##..###

#####...#
#.##..##.
...#.#..#
..##.#.#.
..####.#.
...#.#..#
#.##..##.
#####...#
.......#.
##..###.#
..#.#.#..
#...#...#
###..##.#
.#..##..#
.#..##..#

###....#####.##.#
###....#####.##.#
.########..#.####
...#..#....#.#..#
#.#.##.#.###.####
.#.####.#.#.##...
#.#....#.#..##...
...#..#..#.#.....
##..##..#####.###
.###..###.#...#..
..######...##....
.###..###....#..#
....##.....#####.
#........###.#..#
#...##...##.#####

###.##.
##.#..#
##.#..#
###.##.
.##....
.##..#.
#..####

######.
###.#..
..###.#
..###.#
###.#..
######.
#.#.#..
..###.#
......#
####..#
##.####
##.####
####..#
......#
..#.#.#
#.#.#..
######.

...##.......#.#..
..#..#.#...#..##.
...##.......#.##.
............#.#.#
###########.###..
#.#..#.##..#...#.
..#..#.......##..
..####...###.....
..####...###.....
..#..#.......##..
#.#..#.##..#...#.

.####...#..##
#.##..####.##
.#####.#.##..
##..###...###
.##.##.######
#..#####...##
##.#..#.#.##.
#..#...#...##
.##..#..#.###
#.##....#.###
...#####.#...
#.###.....#..
#.###.....#..
...#####.#...
#.##....#.###

.#.##.#..
#..##..##
..#..#.##
##.##.###
.#.##.#..
.######..
##.##.###

..##..##..#
.###.#..#..
....#....##
....#....##
.###....#..
..##..##..#
#.##..#.#..
#.##..#.#..
..##..##..#
.###....#..
....#....##

##.#..#
..#....
...#..#
##..##.
...####
....##.
...#.##

#.##.#...
######.##
..##.....
.####..##
.####..#.
.#..#....
..##..###
#....##..
......###
#.##.##..
#....#...

..#.#......#.#...
###..##..##..####
.#.##########.#..
.#...######.#.#..
.####.#..#.####..
##.###....###.###
#..##########..##
.###.#....#.###..
...#.#....#.#....
###....##....####
.#...##..##...#..
###.##.##.##.####
##.###.##.###.###
####...##...#####
####..#..#..#####
##.#..#..#..#.###
....##.##.##.....

#..########..##
..#.#....#.#...
#..#..##..#..##
##.#.####.#.###
....##..##.....
##.####.###.###
#.###....###.##
..#.##..##.#...
...##....##....
.##.#....#.##..
##....##....###
..#.######.#...
##..######..###

....#..#.
###.####.
...######
.#.#.##.#
#.###..##
..#######
#.#######
#.#......
.#.#....#
#..#.#..#
.####..##
#.#..##..
#.#..##..

..####..##..####.
...##.#.##.#.##..
..#...##..##...#.
##.##..#####.##.#
....##.#..#.##...
..#.##.#..#.##.#.
##.####....####.#
...##.######.##..
##.##..#..#..##.#
###.#.######.#.##
##.#.###..###.#.#
....#........#...
..###.#....#.###.

#.##.#......#..#.
......###.##...##
#....#....##....#
#.##.#...####..##
..##..#.#.#......
..##...###...##..
.#..#..###.......

####.##.#..##.#
..#...##..#####
.##..#.......#.
.##..#.......#.
..#...##..#####
####.##.#..##.#
####...#..#....
....###.###.###
..###.#.#.##.##
.####.#.######.
.####.#.###.##.
..###.#.#.##.##
....###.###.###
####...#..#....
####.##.#..##.#

#####...##..#..
...#.#.#.#.##.#
.#.####..#.####
#...##.#.#..##.
....##.#.#####.
##..#....###.#.
#######.....##.
##..#####..#...
##..#####..#...
#######.....##.
##..#....###.#.
....##.#.#####.
#...##.#.#..##.
.#.####..#.####
...#.#.#.#.#..#
#####...##..#..
#####...##..#..

..#......#..#....
.###.##.###..#..#
.##..##..##..####
##.##..##.##.####
#.##.##.##.##.##.
.##.####.##......
#..#.##.#..#.####
..###..###.......
..##.##.##...#..#
.#..#..#..#.#.##.
#..#####...#..##.
##.######.###.##.
.#.##..##.#...##.
##........##.#..#
.##.#..#.##.##..#

..#.########.#.
...#.######.#..
##.#.#....#.#.#
##....####....#
..#######.####.
###.#......#.##
##..#..##..#..#

.#.##..
.##.###
##.##..
##.....
..#####
..#.###
###.#..
.#.#...
....#..
#..#.##
#....##
..#.###
..#.###
#.#..##
#..#.##
....#..
.#.#...

'''


# puzzle_input = '''#.##..##.
# ..#.##.#.
# ##......#
# ##......#
# ..#.##.#.
# ..##..##.
# #.#.##.#.

# #...##..#
# #....#..#
# ..##..###
# #####.##.
# #####.##.
# ..##..###
# #....#..#

# '''

# Search for a vertical symmetry
def search_vertical(pattern, ignore=None):
  first_line = pattern[0]
  for col in range(1,len(first_line)):
    # Found a candidate
    if( first_line[col] == first_line[col-1] ):
      # Now we are going to search for a symmetry going left and right of this candidate
      right_c = col+1
      left_c = col-2
      
      symmetry_suspected = True
      # Respecting the limits of our line
      while(left_c >= 0 and right_c < len(first_line)):
        if( first_line[left_c] != first_line[right_c] ):
          symmetry_suspected = False
          break
        left_c -= 1
        right_c += 1
      # If we are still suspecting that there's a symmetry
      if symmetry_suspected:
        # Adjusting the limits found, because at least one of the limits were broken on the while loop above
        if( left_c < 0 ):
          left_c = 0
          right_c -= 1
        elif( right_c >= len(first_line)):
          right_c = len(first_line)-1
          left_c += 1
          
        # OK, these are the limits
        leftmost_c = left_c
        rightmost_c = right_c
        
        # Now we check the remaining rows
        all_symmetric = True
        for row in range(1, len(pattern) ):
          left_c = col-1
          right_c = col
          while(left_c >= leftmost_c and right_c <= rightmost_c):
            if( pattern[row][left_c] != pattern[row][right_c] ):
              all_symmetric = False
              break
            left_c -= 1
            right_c += 1
          if not all_symmetric:
            break
        
        # OK, found a symmetry
        if( all_symmetric ):
          # But we accept it only if it's different from the previous
          if( ignore is None or ignore != col ):
            return col
      
  return 0

# Search for a horizontal symmetry
def search_horizontal(pattern, ignore=None):
  # It's relatively simpler than vertical symmetry, because we compare entire rows
  for row in range(1,len(pattern)):
    # Found a candidate
    if( pattern[row] == pattern[row-1]):
      # Let's check the rows above and below
      up_r = row-2
      down_r = row+1
     
      # Checking all the rows until the limits 
      symmetry_suspected = True
      while( up_r >= 0 and down_r < len(pattern)):
        if( pattern[up_r] != pattern[down_r] ):
          symmetry_suspected = False
          break
        up_r -= 1
        down_r += 1
    
      # OK, all symmetric
      if( symmetry_suspected ):
        # But it must be a different symmetry from the previous
        if( ignore is None or ignore != 100*row ):
          return row
  return 0


pattern = list() # Current pattern
summary = 0 # Answer
pattern_list = list() # Because we must redo some analysis on Part Two
summary_list = list() # Again, we must know the previous summary to not repeat

# Proceessing part one
for line in puzzle_input.splitlines():
  # Separating in blocks 
  if len(line) > 0:
    pattern.append(list(line)) # For part one it could be just the string, but we need to change the values in part two, so let's transform the strings into lists
  else:
    # OK, let's process this block. First we try to find a vertical symmetry
    vertical = search_vertical(pattern)
    # Vertical symmetry found
    if( vertical > 0 ):
      # Accumulate the points
      summary += vertical
      # And stores the value for the second part
      summary_list.append(vertical)
    else:
      # No vertical symmetry. Let's try to find a horizontal one
      horizontal = search_horizontal(pattern)
      # Yes, horizontal symmetry found (it's expected)
      if( horizontal > 0 ):
        # Accumulating the points and storing for future use
        summary += 100*horizontal
        summary_list.append(100*horizontal)
      else:
        print("No symmetry found!")
    # Also storing the whole pattern
    pattern_list.append(pattern)
    # And clearing the buffer for next pattern
    pattern = list()
        
print(f"Part One: {summary}")

# Well, let's approach the second part
summary = 0
for index, pattern in enumerate(pattern_list):
  symmetry_found = False
  # Using brute force to find the smudge candidate
  for r in range(len(pattern)):
    for c in range(len(pattern[0])):
      # Changing the current value on this coordinate
      original_value = pattern[r][c]
      if( original_value == '.' ):
        pattern[r][c] = '#'
      else:
        pattern[r][c] = '.'
      
      # Search for a vertical symmetry that is different from the original
      vertical = search_vertical(pattern, ignore=summary_list[index])
      # OK, found
      if( vertical > 0 ):
        summary += vertical
        symmetry_found = True
        break
      else:
        # Search for a horizontal symmetry that is different from the original
        horizontal = search_horizontal(pattern, ignore=summary_list[index])
        # OK, found
        if( horizontal > 0 ):
          summary += 100*horizontal
          symmetry_found = True
          break
        else:
          pattern[r][c] = original_value
    if( symmetry_found ):
      break
  # This shouldn't happen. (Actually it happened a lot when there were still bugs on the code)
  if( not symmetry_found ):
    print("No symmetry after fix")
  
print(f"Part Two: {summary}")