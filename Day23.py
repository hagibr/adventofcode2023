puzzle_input = '''#.###########################################################################################################################################
#.#...#...#...#######...#####.......#...###...#...........###...#...#.......#...#...#...#...#.......#...#####...###...#...###...............#
#.#.#.#.#.#.#.#######.#.#####.#####.#.#.###.#.#.#########.###.#.#.#.#.#####.#.#.#.#.#.#.#.#.#.#####.#.#.#####.#.###.#.#.#.###.#############.#
#.#.#.#.#.#.#.....###.#...#...#.....#.#.#...#.#.........#...#.#.#.#.#.#.....#.#.#.#.#.#.#.#...#.....#.#.###...#...#.#...#.....#...#.........#
#.#.#.#.#.#.#####.###.###.#.###.#####.#.#.###.#########.###.#.#.#.#.#.#.#####.#.#.#.#.#.#.#####.#####.#.###.#####.#.###########.#.#.#########
#.#.#.#.#...#...#...#...#.#.#...#...#.#...#...#...#...#...#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#...#...#.#.#...#.....#...........#.#...#...#...#
#.#.#.#.#####.#.###.###.#.#.#.###.#.#.#####.###.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.###.#.#.#.#.###.###############.#.#####.#.#.#.#
#.#.#...###...#.....###.#...#.....#.#.....#.#...#...#.#...#.#.#...#.#.#...#.#.#...#.#.#.###.#...#.#.#.#...#...#...#...###.....#.......#...#.#
#.#.#######.###########.###########.#####.#.#.#######.#.###.#.#####.#.#####.#.#####.#.#.###.###.#.#.#.#####.###.#.#.#.###.#################.#
#.#.#.......#...###...#...#.........#...#.#.#.......#.#...#.#...#...#.#.....#...#...#.#...#...#.#.#.#.....#.....#.#.#...#.....#.............#
#.#.#.#######.#.###.#.###.#.#########.#.#.#.#######.#.###.#.###.#.###.#.#######.#.###.###.###.#.#.#.#####.#######.#.###.#####.#.#############
#.#.#.......#.#...#.#...#.#.#...>.>...#.#.#...#.....#.#...#.>.>.#.#...#...#.>.>.#...#.#...###.#.#.#.#...#...#.....#.#...#...#.#.#...#...#...#
#.#.#######.#.###.#.###.#.#.#.###v#####.#.###.#.#####.#.#####v###.#.#####.#.#v#####.#.#.#####.#.#.#.#.#.###.#.#####.#.###.#.#.#.#.#.#.#.#.#.#
#...#.......#...#.#...#.#.#.#.###.#.....#...#.#.....#...###...###...#...#...#.#...#.#.#...#...#.#.#.#.#.....#.>.>.#.#...#.#...#...#...#...#.#
#####.#########.#v###.#.#.#.#.###.#.#######.#.#####.#######.#########.#.#####.#.#.#.#.###.#.###.#.#.#.#########v#.#.###.#.#################.#
#...#...........#.>.#.#.#.#.#.#...#.......#.#...#...###...#.......#...#.......#.#.#...###...###.#.#.#.#.........#.#...#.#.#.....#.........#.#
#.#.#############v#.#.#.#.#.#.#.#########.#.###.#.#####.#.#######.#.###########.#.#############.#.#.#.#.#########.###.#.#.#.###.#.#######.#.#
#.#...............#.#.#.#.#.#.#.........#.#...#.#.#.....#.........#.......#.....#...#...#.....#.#.#.#.#.....#...#.....#...#...#.#.......#...#
#.#################.#.#.#.#.#.#########.#.###.#.#.#.#####################.#.#######.#.#.#.###.#.#.#.#.#####.#.#.#############.#.#######.#####
#.....#...........#.#.#...#...###...#...#.....#.#.#.....................#...#.......#.#...#...#.#.#.#.#...#...#.......#.......#.#.......#...#
#####.#.#########.#.#.###########.#.#.#########.#.#####################.#####.#######.#####.###.#.#.#.#.#.###########.#.#######.#.#######.#.#
#...#...#...###...#.#.###...#.....#...#####...#...###...###.............#...#.........#...#...#...#...#.#.............#.......#.#.........#.#
#.#.#####.#.###.###.#.###.#.#.#############.#.#######.#.###.#############.#.###########.#.###.#########.#####################.#.###########.#
#.#.#.....#.....###...#...#.#.....###...#...#...#.....#...#...........#...#...#.......#.#.#...#...#...#...............#.......#.............#
#.#.#.#################.###.#####.###.#.#.#####.#.#######.###########.#.#####.#.#####.#.#.#.###.#.#.#.###############.#.#####################
#.#.#...............###...#.....#.....#.#.....#.#.....#...#...........#...#...#.....#...#...###.#...#.#...#...........#.............#.......#
#.#.###############.#####.#####.#######.#####.#.#####.#.###.#############.#.#######.###########.#####.#.#.#.#######################.#.#####.#
#.#.........###.....#...#.....#.........###...#.#...#.#...#...#...#...#...#.........###...#...#.....#.#.#...###.....###.............#...#...#
#.#########.###.#####.#.#####.#############.###.#.#.#.###.###.#.#.#.#.#.###############.#.#.#.#####.#.#v#######.###.###.###############.#.###
#.....#...#.....#...#.#.#...#.....#...#...#...#.#.#.#.#...###.#.#.#.#.#...........###...#...#.#...#.#.>.>.....#...#...#.....#...#...###.#.###
#####.#.#v#######.#.#.#.#.#.#####v#.#.#.#.###.#.#.#.#.#.#####v#.#.#.#.###########v###.#######.#.#.#.###v#####.###.###.#####.#.#.#.#.###.#.###
###...#.#.>.....#.#...#.#.#...#.>.>.#...#.#...#...#.#.#.....>.>.#.#.#.#...#...#.>.>...#...###.#.#.#.#...#...#...#.#...#...#...#...#.....#...#
###.###.#v#####.#.#####.#.###.#.#v#######.#.#######.#.#######v###.#.#.#.#.#.#.#.#v#####.#.###.#.#.#.#.###.#.###.#.#.###.#.#################.#
#...#...#...###.#.....#.#.#...#.#.......#.#.......#.#.#.......###...#.#.#...#.#.#...#...#...#.#.#.#.#.....#.#...#.#.###.#.......#...#.......#
#.###.#####.###.#####.#.#.#.###.#######.#.#######.#.#.#.#############.#.#####.#.###.#.#####.#.#.#.#.#######.#.###.#.###.#######.#.#.#.#######
#.....#...#...#.....#.#.#.#...#.#.......#...#...#.#...#...........#...#.#.....#.###.#.#.....#...#.#.###.....#.....#...#.#...###...#.#.#...###
#######.#.###.#####.#.#.#.###.#.#.#########.#.#.#.###############.#.###.#.#####.###.#.#.#########.#.###.#############.#.#.#.#######.#.#.#.###
#.......#.###.....#.#.#.#...#.#.#...#...###...#...#...............#.....#.#...#...#.#.#.........#.#.#...#...#...#.....#...#.......#.#...#...#
#.#######.#######.#.#.#.###.#.#.###.#.#.###########.#####################.#.#.###.#.#.#########.#.#.#.###.#.#.#.#.###############.#.#######.#
#.....#...#...#...#...#.#...#...#...#.#...###...###...#...#.............#...#.#...#.#.#.........#...#.....#...#.#...###...#...#...#.........#
#####.#.###.#.#.#######.#.#######.###.###.###.#.#####.#.#.#.###########.#####.#.###.#.#.#######################.###.###.#.#v#.#.#############
#.....#.....#...#...###...#.......#...###.....#.....#.#.#...#.......#...###...#...#...#.............#...........#...#...#.>.#...###.....#...#
#.###############.#.#######.#######.###############.#.#.#####.#####.#.#####.#####.#################.#.###########.###.#####v#######.###.#.#.#
#...#.............#.....#...#...#...###.............#...#.....#...#...#.....#...#.#.................#...........#...#.#...#.........#...#.#.#
###.#.#################.#.###.#.#.#####.#################.#####.#.#####.#####.#.#.#.###########################.###.#.#.#.###########.###.#.#
###.#.#.................#...#.#...#...#...........#...#...#...#.#.#...#.....#.#...#...#...........#.....###.....###.#.#.#.#.........#...#.#.#
###.#.#.###################.#.#####.#.###########.#.#.#.###.#.#.#.#.#.#####.#.#######.#.#########.#.###.###.#######.#.#.#.#.#######.###.#.#.#
###...#.#.................#...#.....#.###.........#.#.#...#.#.#.#.#.#.#...#...#...###...#.....#...#...#...#.......#...#.#...###...#...#...#.#
#######.#.###############.#####.#####.###.#########.#.###.#.#.#.#.#.#.#.#.#####.#.#######.###.#.#####.###.#######.#####.#######.#.###.#####.#
#.......#.#...............#.....#...#.#...#####.....#...#...#...#.#.#.#.#...###.#.....#...###...#####...#.......#.#.....#.......#...#.#...#.#
#.#######.#.###############.#####.#.#.#.#######.#######.#########.#.#.#.###.###.#####.#.###############.#######.#.#.#####.#########.#.#.#.#.#
#.........#...............#.......#.#.#.......#.....#...#...#.....#.#.#...#.....#.....#.....###...#####.......#.#.#.......#.........#...#...#
#########################.#########.#.#######.#####.#.###.#.#v#####.#.###.#######.#########.###.#.###########.#.#.#########.#################
#...#...#...#.............###...#...#.........#.....#.....#.>.>.#...#...#...#.....#.........#...#...###...#...#.#.#.....###...#####...#.....#
#.#.#.#.#.#.#.###############.#.#.#############.#############v#.#.#####.###.#.#####.#########.#####.###.#.#v###.#.#.###.#####.#####.#.#.###.#
#.#.#.#.#.#.#...###...#...###.#.#.....#...#...#...........#...#...#.....#...#.....#...#.....#.....#...#.#.>.>.#...#...#...###.......#.#.#...#
#.#.#.#.#.#.###.###.#.#.#.###.#.#####.#.#.#.#.###########.#.#######.#####.#######.###.#.###.#####.###.#.###v#.#######.###.###########.#.#.###
#.#...#...#.....#...#.#.#.#...#...###...#.#.#.#...#.......#...#...#.......#.......###...#...#####...#...#...#...###...#...#...........#.#...#
#.###############.###.#.#.#.#####.#######.#.#.#.#.#.#########.#.#.#########.#############.#########.#####.#####.###.###.###.###########.###.#
#...#.....#.....#.#...#.#.#.....#.#...###.#.#.#.#.#...###...#...#.....#.....###...#...#...#####...#.#...#.#...#...#...#.###...###.......#...#
###.#.###.#.###v#.#.###.#.#####.#.#.#.###v#.#.#.#.###.###.#.#########.#.#######.#.#.#.#.#######.#.#.#.#.#.#.#.###.###.#.#####.###.#######.###
###.#.#...#.###.>.#.#...#...#...#.#.#.#.>.>.#...#.#...#...#...........#.....#...#...#.#...###...#.#.#.#...#.#...#...#.#.#...#.#...#.......###
###.#.#.###.###v###.#.#####.#.###.#.#.#.#v#######.#.###.###################.#.#######.###.###.###.#.#.#####.###.###.#.#.#.#.#v#.###.#########
#...#.#.....#...###...#.....#...#...#...#.......#.#.###.............#.......#.#.......#...#...###...#.....#.#...###.#.#.#.#.>.#...#.#####...#
#.###.#######.#########.#######.###############.#.#.###############.#.#######.#.#######.###.#############.#.#.#####.#.#.#.###v###.#.#####.#.#
#...#.#.......#.......#.........###...#.....#...#.#.#...........#...#.......#.#.###...#...#.......#...###...#.....#.#.#.#...#...#.#.......#.#
###.#.#.#######.#####.#############.#.#.###.#.###.#.#.#########.#.#########.#.#.###.#.###v#######.#.#.###########.#.#.#.###.###.#.#########.#
###...#.......#.#...#...#...........#...###.#...#...#.........#.#.#.....#...#.#.#...#.#.>.>.#.....#.#.#...........#...#.....###...#.........#
#############.#.#.#.###.#.#################.###.#############.#.#.#.###.#.###.#.#.###.#.#v#.#.#####.#.#.###########################.#########
#.............#.#.#.....#.................#.#...###...#.......#...#.#...#.#...#...###...#.#...#.....#.#.......#...###...#...#.......#...#...#
#.#############.#.#######################.#.#.#####.#.#.###########.#.###.#.#############.#####.#####.#######.#.#.###.#.#.#.#.#######.#.#.#.#
#.........#.....#.........###.............#.#.#...#.#.#...........#.#.#...#.#...........#.....#.#...#.......#.#.#...#.#...#...#.......#...#.#
#########.#.#############.###.#############.#.#.#.#.#.###########.#.#.#.###.#.#########.#####.#.#.#.#######.#.#.###.#.#########.###########.#
#.........#.#...........#...#.............#.#.#.#...#...#.........#.#.#.....#...#.....#.#.....#.#.#...#...#.#.#...#.#...........###...#...#.#
#.#########.#.#########.###.#############.#.#.#.#######.#.#########.#.#########.#.###.#.#.#####.#.###.#.#.#.#.###.#.###############.#.#.#.#.#
#.#.......#.#.#...#...#.....###...........#...#...#.....#.#.......#.#.....#.....#.#...#...#...#...###...#.#.#...#.#.#.....#...#...#.#.#.#.#.#
#.#.#####.#.#.#.#v#.#.#########.#################.#.#####v#.#####.#.#####.#.#####.#.#######.#.###########.#.###.#.#.#.###.#.#.#.#.#v#.#.#.#.#
#...#...#...#...#.>.#...#.......#...###...###...#.#...#.>.>.#.....#.#.....#...#...#.........#.#...........#.#...#.#...#...#.#...#.>.#...#...#
#####.#.#########v#####.#.#######.#.###.#.###.#.#.###.#.#v###.#####.#.#######.#.#############.#.###########.#.###.#####.###.#######v#########
#.....#.........#.#...#.#.........#...#.#.....#...#...#.#.#...#...#.#.......#...###...........#.......#...#...###.....#.#...#.....#.......###
#.#############.#.#.#.#.#############.#.###########.###.#.#.###.#.#.#######.#######.#################.#.#.###########.#.#.###.###.#######.###
#.............#.#.#.#...#...#...#.....#.........###.#...#.#...#.#.#.#.......#.......###.....#.....#...#.#...#.....#...#.#...#...#.#.....#...#
#############.#.#.#.#####.#.#.#.#.#############.###.#.###.###.#.#.#.#.#######.#########.###.#.###.#.###.###.#.###.#.###.###.###.#.#.###.###.#
#...#...###...#...#.#...#.#.#.#.#...#...#.....#.#...#.#...###.#.#.#.#...#...#.........#.#...#...#.#.....#...#...#...#...#...#...#.#...#...#.#
#.#.#.#.###.#######.#.#.#.#.#.#.###v#.#.#.###.#.#.###.#.#####.#.#.#.###.#.#.#########.#.#.#####.#.#######.#####.#####.###.###.###.###.###.#.#
#.#...#...#.......#.#.#.#.#.#.#.#.>.>.#.#.###...#.#...#.....#...#...#...#.#.....#.....#.#.....#.#.#...#...#...#.....#...#.#...###.....###...#
#.#######.#######.#.#.#.#.#.#.#.#.#v###.#.#######.#.#######.#########.###.#####.#.#####.#####.#.#.#.#.#.###.#.#####.###.#.#.#################
#...#...#.#.....#.#.#.#.#.#.#.#...#...#.#.....#...#.#.......#.......#...#.#.....#...###.#.....#.#.#.#.#...#.#.#...#...#...#.........#...#...#
###.#.#.#.#.###.#.#.#.#.#.#.#.#######.#.#####.#.###.#.#######.#####.###.#.#.#######v###.#.#####.#.#.#.###v#.#.#.#.###.#############.#.#.#.#.#
###...#.#.#...#...#.#.#.#.#.#.#.......#.......#.....#.........#.....#...#.#.#.....>.>.#.#...#...#.#.#...>.>.#...#.....#.....#.......#.#.#.#.#
#######.#.###.#####.#.#.#.#.#.#.###############################.#####.###.#.#.#####v#.#.###.#.###.#.#####v#############.###.#.#######.#.#.#.#
#.......#.....#...#...#...#...#...................#...........#...#...#...#...###...#...###.#.#...#.#...#.....#...#...#...#...#...#...#...#.#
#.#############.#.###############################.#.#########.###.#.###.#########.#########.#.#.###.#.#.#####.#.#.#.#.###.#####.#.#.#######.#
#.......#.......#...........#.....................#.....#...#.....#.....#...#...#.........#...#.....#.#.#...#...#...#...#.......#...#.....#.#
#######.#.#################.#.#########################.#.#.#############.#.#.#.#########.###########.#.#.#.###########.#############.###.#.#
#.....#...#.................#...#...........#...#...###...#.......#.......#.#.#.#.....#...#...........#.#.#.#...#.......#...#.........###...#
#.###.#####.###################.#.#########.#.#.#.#.#############.#.#######.#.#.#.###.#.###.###########.#.#.#.#.#.#######.#.#.###############
#...#.......#.......#...###.....#.#.........#.#...#.#...#...#...#.#.......#...#...#...#...#...........#.#.#.#.#.#.###...#.#.#.......###...###
###.#########.#####.#.#.###.#####.#.#########.#####.#.#.#.#.#.#.#.#######.#########.#####.###########.#.#.#.#.#.#.###.#.#.#.#######.###.#.###
###.........#.#.....#.#...#.......#.....#...#.....#.#.#.#.#.#.#.#.#.....#.........#.....#.#...........#...#.#.#.#...#.#...#.........#...#...#
###########.#.#.#####.###.#############.#.#.#####.#.#.#.#.#.#.#.#v#.###.#########.#####.#.#.###############.#.#.###.#.###############.#####.#
#...#...###...#...###...#.#...#.........#.#.#...#.#.#.#.#.#.#.#.>.>.#...#.......#...###...#...............#...#.....#.........#...#...#...#.#
#.#.#.#.#########v#####.#.#.#.#.#########.#.#.#.#.#.#.#.#.#.#.###v###.###.#####.###.#####################.###################.#.#.#.###.#.#.#
#.#.#.#.#.....###.>.###.#.#.#.#.........#.#.#.#.#.#.#.#.#.#...###...#...#.....#.....#...#.....#...........#...###...###...###...#...#...#.#.#
#.#.#.#.#.###.###v#.###.#.#.#.#########.#.#.#.#.#.#.#.#.#.#########.###.#####.#######.#.#.###.#.###########.#.###.#.###.#.###########.###.#.#
#.#.#.#.#.#...#...#...#.#.#.#.###...#...#.#...#.#.#...#...#...#.....###...###.......#.#.#...#.#.....###...#.#.#...#.#...#.#.......#...#...#.#
#.#.#.#.#.#.###.#####.#.#.#.#.###.#.#v###.#####.#.#########.#.#.#########.#########.#.#.###.#.#####v###.#.#.#.#.###.#.###.#.#####.#.###.###.#
#.#.#.#.#.#.#...#...#.#.#.#.#...#.#.>.>.#.....#.#.#.......#.#.#...#######.#.........#.#.#...#...#.>.>.#.#.#.#.#...#.#.#...#...#...#...#.....#
#.#.#.#.#.#.#.###.#.#.#.#.#.###.#.###v#.#####.#.#.#.#####.#.#.###.#######.#.#########.#.#.#####.#.#v#.#.#.#.#.###.#.#.#.#####v#.#####.#######
#.#...#.#.#.#.....#.#.#.#...###...#...#.#...#.#...#.#.....#.#...#.....#...#...#...###.#.#.....#...#.#.#.#...#.#...#...#.#...>.#...#...#...###
#.#####.#.#.#######.#.#.###########.###.#.#.#.#####.#.#####.###.#####.#.#####v#.#.###.#.#####.#####.#.#.#####.#.#######.#.###v###.#.###.#.###
#.....#.#.#.........#.#.#.........#.#...#.#.#...#...#.....#...#.#.....#...#.>.>.#...#.#.#...#.....#.#...###...#.....###...#...###...#...#...#
#####.#.#.###########.#.#.#######.#.#.###.#.###.#.#######.###.#.#.#######.#.#v#####.#.#.#.#.#####.#.#######.#######.#######.#########.#####.#
#...#.#.#...........#...#.......#.#.#...#.#.#...#...#...#.....#...#...###...#.....#.#.#.#.#.......#.......#.#...#...#.......#...###...#.....#
#.#.#.#.###########.###########.#.#.###.#.#.#.#####.#.#.###########.#.###########.#.#.#.#.###############.#.#.#.#.###.#######.#.###.###.#####
#.#...#.....#...#...#...........#...###.#.#...###...#.#.......#...#.#.#.....###...#.#.#.#.....#...........#...#...###...#.....#...#.#...#####
#.#########.#.#.#.###.#################.#.#######.###.#######.#.#.#.#.#.###.###.###.#.#.#####.#.#######################.#.#######.#.#.#######
#.#.......#.#.#.#.###.#...............#.#.......#.....#...###...#...#.#...#.....#...#.#.......#.....................#...#...#...#...#.#...###
#.#.#####.#.#.#.#.###.#.#############.#.#######.#######.#.###########.###.#######.###.#############################.#.#####.#.#.#####.#.#.###
#...###...#...#...#...#...#.......#...#.........#.......#.......#...#...#...#...#.....#.........#...#...............#.#...#.#.#.......#.#.###
#######.###########.#####.#.#####.#.#############.#############.#.#.###.###.#.#.#######.#######.#.#.#.###############.#.#.#.#.#########.#.###
#.......#...###...#.......#.....#...#...........#.............#...#.....#...#.#.......#...#.....#.#...#...#...#...###...#...#...........#...#
#.#######.#.###.#.#############.#####.#########.#############.###########.###.#######.###.#.#####.#####.#.#.#.#.#.#########################.#
#.....###.#...#.#.#...#...#.....###...#.....#...#...#...###...#.........#...#.#.......#...#.#...#.......#...#...#.......#...........#.....#.#
#####.###.###.#.#.#.#.#.#.#.#######.###.###.#.###.#.#.#.###.###.#######.###.#.#.#######.###.#.#.#######################.#.#########.#.###.#.#
#...#.....#...#.#.#.#.#.#.#.........#...###...#...#.#.#...#.#...#.......###...#.......#...#.#.#.#.......#.....#.........#.........#...###...#
#.#.#######.###.#.#.#.#.#.###########.#########.###.#.###.#.#.###.###################.###.#.#.#.#.#####.#.###.#.#################.###########
#.#.#...#...#...#...#.#.#.#.........#.....#...#...#.#...#.#...#...###...#...#.........#...#.#.#.#.....#...###...#...#.......#...#...........#
#.#.#.#.#.###.#######.#.#.#.#######.#####.#.#.###.#.###.#.#####.#####.#.#.#.#.#########.###.#.#.#####v###########.#.#.#####.#.#.###########.#
#.#...#...###.....#...#.#.#.....###.#.....#.#.#...#...#.#.#...#.....#.#.#.#.#.........#...#.#.#.#...>.>.###.....#.#.#.....#.#.#.......#.....#
#.###############.#.###.#.#####v###.#.#####.#.#.#####.#.#.#.#.#####.#.#.#.#.#########.###.#.#.#.#.#####.###.###.#.#.#####.#.#.#######.#.#####
#...........#.....#.#...#...#.>.>.#...#...#.#.#.#.....#.#.#.#.###...#.#.#.#.#...#.....#...#.#.#.#.#####...#.#...#.#...#...#.#.......#...#...#
###########.#.#####.#.#####.#.###.#####.#.#.#.#.#.#####.#.#.#.###v###.#.#.#.#.#.#v#####.###.#.#.#.#######.#.#.###.###.#.###.#######.#####.#.#
#...........#.#.....#.#####.#.#...#...#.#.#.#.#.#.#...#.#...#.#.>.>...#...#.#.#.>.>...#...#.#.#.#...#.....#.#...#...#.#.#...#...#...#...#.#.#
#.###########.#.#####.#####.#.#.###.#.#.#.#.#.#.#.#.#.#.#####.#.###########.#.#######.###.#.#.#.###.#.#####.###.###.#.#.#.###.#.#v###.#.#.#.#
#.....#...#...#.....#.#.....#.#.#...#.#.#...#.#.#.#.#.#.....#.#.........#...#.###.....#...#...#.....#...#...###...#.#.#.#...#.#.>.###.#...#.#
#####.#.#.#.#######.#.#.#####.#.#.###.#.#####.#.#.#.#.#####.#.#########.#.###.###.#####.###############.#.#######.#.#.#.###.#.###v###.#####.#
#.....#.#.#.......#.#.#.#...#.#.#.###.#...#...#.#.#.#...#...#.#...#.....#...#...#.#...#.........#.......#.#.......#.#.#...#.#...#...#.#.....#
#.#####.#.#######.#.#.#.#.#.#.#.#.###.###.#.###.#.#.###.#.###.#.#.#.#######.###.#.#.#.#########.#.#######.#.#######.#.###.#.###.###.#.#.#####
#.......#.........#...#...#...#...###.....#.....#...###...###...#...#######.....#...#...........#.........#.........#.....#.....###...#.....#
###########################################################################################################################################.#
'''

# puzzle_input = '''#.#####################
# #.......#########...###
# #######.#########.#.###
# ###.....#.>.>.###.#.###
# ###v#####.#v#.###.#.###
# ###.>...#.#.#.....#...#
# ###v###.#.#.#########.#
# ###...#.#.#.......#...#
# #####.#.#.#######.#.###
# #.....#.#.#.......#...#
# #.#####.#.#.#########v#
# #.#...#...#...###...>.#
# #.#.#v#######v###.###v#
# #...#.>.#...>.>.#.###.#
# #####v#.#.###v#.#.###.#
# #.....#...#...#.#.#...#
# #.#########.###.#.#.###
# #...###...#...#...#.###
# ###.###.#.###v#####v###
# #...#...#.#.>.>.#.>.###
# #.###.###.#.###.#.#v###
# #.....###...###...#...#
# #####################.#'''

hiking_map = []

distances = dict()
previous = dict()
next = dict()
for r, line in enumerate(puzzle_input.splitlines()):
  hiking_map.append(list(line))
  for c, val in enumerate(line):
    if val in ('.','>','<','^','v'):
      distances[(r,c)] = 0
      previous[(r,c)] = None
      next[(r,c)] = None

last_row = len(hiking_map) - 1
last_col = len(hiking_map[0]) - 1

first_pos = (0,1)
last_pos = (last_row, last_col-1)

visited = []
to_visit = [first_pos]
distances[first_pos] = 0


while len(to_visit) > 0:
  next_pos = to_visit[0]
  highest_distance = distances[next_pos]
  for pos in to_visit[1:]:
    if distances[pos] > highest_distance:
      next_pos = pos
      highest_distance = distances[pos]
  visited.append(next_pos)
  to_visit.remove(next_pos)
  r,c = next_pos
  print(next_pos)
  next_distance = distances[next_pos] + 1
  if( hiking_map[r][c] == '^' ):
    if r > 0 and hiking_map[r-1][c] in ('.','^') and previous[next_pos] != (r-1,c):
      if next_distance > distances[(r-1,c)]:
        distances[(r-1,c)] = next_distance
        previous[(r-1,c)] = next_pos
      if (r-1,c) not in visited:
        to_visit.append((r-1,c))
  elif( hiking_map[r][c] == 'v' ):
    if r < last_row and hiking_map[r+1][c] in ('.','v') and previous[next_pos] != (r+1,c):
      if next_distance > distances[(r+1,c)]:
        distances[(r+1,c)] = next_distance
        previous[(r+1,c)] = next_pos
      if (r+1,c) not in visited:
        to_visit.append((r+1,c))
  elif( hiking_map[r][c] == '<' ):
    if c > 0 and hiking_map[r][c-1] in ('.','<') and previous[next_pos] != (r,c-1):
      if next_distance > distances[(r,c-1)]:
        distances[(r,c-1)] = next_distance
        previous[(r,c-1)] = next_pos
      if (r,c-1) not in visited:
        to_visit.append((r,c-1))
  elif( hiking_map[r][c] == '>' ):
    if c < last_col and hiking_map[r][c+1] in ('.','>') and previous[next_pos] != (r,c+1):
      if next_distance > distances[(r,c+1)]:
        distances[(r,c+1)] = next_distance
        previous[(r,c+1)] = next_pos
      if [r,c+1] not in visited:
        to_visit.append((r,c+1))
  else:  
    if r > 0 and hiking_map[r-1][c] in ('.','^') and previous[next_pos] != (r-1,c):
      if next_distance > distances[(r-1,c)]:
        distances[(r-1,c)] = next_distance
        previous[(r-1,c)] = next_pos
      if (r-1,c) not in visited:
        to_visit.append((r-1,c))
    if r < last_row and hiking_map[r+1][c] in ('.','v') and previous[next_pos] != (r+1,c):
      if next_distance > distances[(r+1,c)]:
        distances[(r+1,c)] = next_distance
        previous[(r+1,c)] = next_pos
      if (r+1,c) not in visited:
        to_visit.append((r+1,c))
    if c > 0 and hiking_map[r][c-1] in ('.','<') and previous[next_pos] != (r,c-1):
      if next_distance > distances[(r,c-1)]:
        distances[(r,c-1)] = next_distance
        previous[(r,c-1)] = next_pos
      if (r,c-1) not in visited:
        to_visit.append((r,c-1))
    if c < last_col and hiking_map[r][c+1] in ('.','>') and previous[next_pos] != (r,c+1):
      if next_distance > distances[(r,c+1)]:
        distances[(r,c+1)] = next_distance
        previous[(r,c+1)] = next_pos
      if [r,c+1] not in visited:
        to_visit.append((r,c+1))



current_pos = last_pos

count = 0
hiking_map[current_pos[0]][current_pos[1]] = 'O'
while( current_pos != first_pos ):
  current_pos = previous[current_pos]
  count += 1
  hiking_map[current_pos[0]][current_pos[1]] = 'O'
  
hiking_map[first_pos[0]][first_pos[1]] = 'S'
for line in hiking_map:
  print(''.join(line))
    
print(f"Part One: {count}")
# 2062: Too low

